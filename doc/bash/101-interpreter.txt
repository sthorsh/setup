PIPELINE

GNU readline library
  Leser tegn fra terminalen
  En newline betyr end-of-line
  Output: linje/strøm/buffer m/tegn

GNU history library
  Ekspanderer !
  Skriver til ~/.bash_history
  Output: readline + history stream

Lexer: scanner tegn
    Identifiserer leksemer: vha metategn
    Fjerner kommentarer # ...
    Kategoriserer leksemer: token = (type, verdi)
    Sjekker 1st token: hvis alias → ekspanderer alias
    Sjekker 1st token: hvis opening keyword → leser neste cmd
    Output: linje/strøm/buffer m/tokens
    URL: https://en.wikipedia.org/wiki/Lexical_analysis
    URL: https://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_03
  
Parser: parser tokens
    Sjekker syntaks
    Kaster syntaksfeil (evt)
    Bygger en «command structure» (datastruktur)
    Output: command structure (representerer kommandoen)
  
  Makroprosessor
    Ekspanderer braces
    Ekspanderer tilde
    Ekspanderer params
    Substituerer kommando (subskall)
    Ekspanderer aritmetiske expr
    Substituerer prosess  (subskall)
    Splitter felt i ord vha IFS (word splitting)
    Ekspanderer filnavn
    Fjerner escape- og sitattegn
    Output: command structure
  
  Kjøresystem
    Utfører omdirigeringer
    Ekspanderer og tilordner variabelverdier
    Antar første ord er navn, resten er args
    Hvis navn uten slash && navn matcher funksjon
    • Kjører funksjon → done
    Hvis navn uten slash && navn matcher builtin
    • Kjører builtin → done
    Gjør path-søk etter kjørbar fil
    Hvis navn med slash || path-søk treff
    • Bash: syskall fork
    • Bash: lager kjøremiljø
    • Bash: syskall wait: exit status 0..255
    • Barn: syskall exec
    • Barn: kjører kommando i separat kjøremiljø
    • Barn: syskall exit → done
    Bash kan kjøre ikke-kjørbare script som $ bash name (REF: BRM 3.8)
    • Søker i . etter script
    • Søker i path etter script
    • Hvis treff: fork
    Ellers, kaster "command not found"
  
  Outputprosessor
    Leser exit status
    Opphever omdirigeringer
    Eksponerer exit status i $?
  
