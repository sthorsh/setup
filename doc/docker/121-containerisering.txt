CONTAINERISERING

Containerisering
  Applikasjon               src, etc, lib
  Dockerfile                $ man dockerfile

Dockerfile
  FROM registry/repo:tag    base_image (OS)

  LABEL name=value          config Labels

  RUN cmd && cmd ...        legg nytt layer på current image
                            kjør /bin/sh -c cmd && ...
                            evt: commit intermediate container

  ARG name=value            build: vardef
                            image: -
                            runtime: -

  ENV name value            build: vardef
                            image: config Env
                            runtime: vardef

  USER user[:group]         build: sett bruker til user
                            image: config User
                            runtime: sett bruker til user

  WORKDIR path              build: sett working directory til path
                            image: config WorkingDir
                            image: path må opprettes → nytt layer
                            runtime: sett working directory til path

  ADD path|tar|url path     image: nytt layer

  COPY path path            image: nytt layer

  EXPOSE port               porter to be published
                            image: config ExposedPorts
                            runtime: run -p ...

  VOLUME directory          mount point
                            image: config Volumes
                            runtime: run -v ...

  ENTRYPOINT exec|shell     shell|exec
                            image: config Entrypoint

  CMD shell|exec|param      set default command to execute
                            image: config Cmd
                            runtime: not overridden → run command
                                                 
$ docker build ...
  Klient: sender build_context til engine
  Server: for hver instruksjon (step 1/N) 
    Starter intermediate container
    Utfører instruksjonen
    Effekt: ingen endring | endret config | nytt layer
    Fjerner intermediate container
  Server: successfully built 757450e29ce9 → application image (final image)

