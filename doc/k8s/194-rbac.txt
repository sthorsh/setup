RBAC

Autorisasjon
  Tillate requestor å utføre action på ressurs: ja/nei
  Basert på Restful API semantikk verb on noun: e.g get pods
  Regler tillater å utføre action på ressurs: default er deny
  K8s binder subjekter til regler: svc accounts, users, groups

RBAC
  Rollebasert aksesskontroll
  Authz plugin enabled på apiserver

Subjekt
  User
  Group
  Service Account
  
API objekter
  Role
  RoleBinding
  ClusterRole
  ClusterRoleBinding

Role
  Definerer verb on noun (hva)
  Namespaced
  Består av en eller flere regler i.e verb on noun
  Default for k8s er deny verb on noun (regler allows)

RoleBinding
  Definerer subjekter (hvem)
  Refererer til Roles
  Namespaced

ClusterRole
  Cf Role
  På tvers av namespace evt cluster-wide
  Default ClusteRoles: admin, edit, view, cluster-admin, ...

ClusterRoleBinding
  Cf RoleBinding
  På tvers av namespace evt cluster-wide

Kombinasjoner
  RoleBinding → Role (pods)
  RoleBinding → ClusterRole (pods)
  ClusterRoleBinding → ClusterRole (pv, noder)

Role API
  apiVersion: rbac.authorization.k8s.io/v1
  kind: Role
  metadata:
    name: demorole
    namespace: ns1
  rules:
  - apiGroups: [""]
    resources: ["pods"]
    verbs: [*, "get", "list", "create", "update", "patch", "watch", "delete", "deletecollection"]

RoleBinding API
  apiVersion: rbac.authorization.k8s.io/v1
  kind: RoleBinding
  metadata:
    name: demorolebinding
    namespace: ns1
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: Role
    name: demorole
  subjects:
  - apiGroup: rbac.authorization.k8s.io
    kind: User | Group | ServiceAccount
    name: mysvcaccount1 | demouser | demogroup                
    namespace: ns1
  
