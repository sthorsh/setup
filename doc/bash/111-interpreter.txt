INTERPRETER (BASH INTERNAL PIPELINE)

Inputprosessor
  Leser tegn fra terminalen, fil eller streng
  Readline leser tegn-for-tegn fra terminalen
  Readline bufrer tegn til mottak av en newline
  Output: strøm av tegn (for _en_ kommandolinje)

Lexer
  Tokeniserer linjen
  Klassifiserer tokens (escape- og sitattegn)
  Ekspanderer history events
  Ekspanderer alias
  Output: strøm av tokens (ord og operatorer)

Parser
  Verifiserer input
  Kaster syntaksfeil (evt)
  Bygger en «command structure» (datastruktur)
  Output: command structure (representerer kommandoen)

Makroprosessor
  Ekspanderer braces
  Ekspanderer tilde
  Ekspanderer params
  Substituerer kommando (subskall)
  Ekspanderer aritmetiske expr
  Substituerer prosess  (subskall)
  Felt-/orddeling
  Ekspanderer filnavn
  Fjerner escape- og sitattegn
  Output: command structure

Kjøresystem
  Utfører omdirigeringer
  Ekspanderer og tilordner variabelverdier
  Antar første ord er navn, resten er args
  Hvis navn uten slash && navn matcher funksjon
  • Kjører funksjon → done
  Hvis navn uten slash && navn matcher builtin
  • Kjører builtin → done
  Gjør path-søk etter kjørbar fil
  Hvis navn med slash || path-søk treff
  • Bash: syskall fork
  • Bash: lager kjøremiljø
  • Bash: syskall wait: exit status 0..255
  • Barn: syskall exec
  • Barn: kjører kommando i separat kjøremiljø
  • Barn: syskall exit → done
  Bash kan kjøre ikke-kjørbare script som $ bash name (REF: BRM 3.8)
  • Søker i . etter script
  • Søker i path etter script
  • Hvis treff: fork
  Ellers, kaster "command not found"

Outputprosessor
  Leser exit status
  Opphever omdirigeringer
  Eksponerer exit status i $?

