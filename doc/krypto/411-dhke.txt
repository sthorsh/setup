DHKE

Params
  A        alice
  prkA     alice privat nøkkel
  pbkA     alice public nøkkel
  B        bob
  prkB     bob privat nøkkel
  pbkB     bob public nøkkel
  p        primtall
  g        generator, for hvert tall n finnes g^k slik at n = g^k % p
  secret   nøkkelmateriale
  sk       symmetrisk nøkkel (feks AES)

Protokoll
  A genererer params g og p
  A genererer prkA
  A genererer pbkA = g^prkA % p
  A sender pbkA til B
  A mottar pbkB fra B
  A avleder secret = pbkB^prkA % p
  A avleder sk = pbdkf2(prf, secret, salt, c, skLen)

  B mottar params fra A
  B genererer prkB
  B genererer pbkB = g^prkB % p
  B sender pbkB til A
  B mottar pbkA fra A
  B avleder secret = pbkA^prkB % p
  B avleder sk = pbdkf2(prf, secret, salt, c, skLen)

