SIKKERHET

Klient/server
  Bruker → apiserver
  Service Account → apiserver
  Scheduler → apiserver
  Controller manager → apiserver
  Kubelet → apiserver
  Kube-proxy → apiserver
  ...

Apiserver trinn
  Autentisering ✓
  Autorisasjon  ✓ 
  Adgangskontroll ✓
  Prosessering av request
  
Bruker
  Et menneske aksesserer apiserver e.g kubectl
  Apiserver autentiserer: User Account e.g admin
  API objekt: n/a
  Credentials defineres og lagres utenfor K8s:
    • passordfil
    • tokens
    • sertifikat
    • katalogtjeneste
  Brukernavn brukes ifm autorisasjon, adgangskontroll og logging
  En eller flere brukere kan organiseres i en eller flere grupper
  
Service Account (sa)
  Prosess i container i pod aksesserer apiserver
  Apiserver autentiserer: Service Account e.g default
  API objekt: ServiceAccount (namespaced)
  Credentials defineres og lagres i K8s (token)
  SA brukes for autentisering, autorisasjon, kryptering
  Hvert ns har en default sa (default)
  Hver pod refererer til en sa e.g default
  Hver sa har en liste med secrets e.g default-token-6z6hs
  Hver secret har data med elementer ca.crt, namespace, token
  I container fs: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
  I container fs: /var/run/secrets/kubernetes.io/serviceaccount/namespace
  I container fs: /var/run/secrets/kubernetes.io/serviceaccount/token
  Ved opprettelse av en sa lager en controller en secret automatisk

Autentisering
  Basic HTTP
    • statisk passordfil
  Token
    • HTTP Authorization Header
  Sertifikat
    • brukernavn CN
    • gruppenavn O/OU
  OIDC
    • ekstern provider
    • gir støtte for SSO
  ...

Autorisasjon
  RBAC

