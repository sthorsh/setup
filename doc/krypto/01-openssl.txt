OPENSSL
  
# openssl
openssl version
  
# openssl
openssl help
  
--------------------
# Generer tilfeldig verdi
openssl rand -hex 32

--------------------
# Beregn hashverdi
cat FILE | openssl dgst -sha256
  
# Beregn hashverdi
echo PASSWORD | openssl dgst -sha256
  
# Beregn saltet hashverdi
openssl passwd -1 -salt SALT PASSWORD
  
--------------------
# Lag nøkkel KEY
openssl rand -hex 32
  
# Krypter fil med AES
openssl enc -aes-256-ecb -in FILE.txt -K KEY > FILE.enc
  
# Dekrypter fil med AES
openssl enc -aes-256-ecb -d -in FILE.enc -K KEY
  
--------------------
# Lag nøkkel med pbkd; krypter fil med AES ECB
openssl enc -aes-256-ecb -in FILE.txt -pbkdf2 > FILE.enc
  
# Dekrypter fil
openssl enc -aes-256-ecb -d -in FILE.enc -pbkdf2
  
--------------------
# Lag nøkkel med pbkd; krypter fil med AES CBC
openssl enc -aes-256-cbc -in FILE.txt -pbkdf2 > FILE.enc
  
# Dekrypter fil
openssl enc -aes-256-cbc -d -in FILE.enc -pbkdf2
  
--------------------
# A el B generer DH params (g, n) 
openssl genpkey -genparam -algorithm DH -out params.pem
  
# A generer privat DH nøkkel (a)
openssl genpkey -paramfile params.pem -out a_private_key.pem
  
# A generer public DH nøkkel (g^a mod n)
openssl pkey -in a_private_key.pem -pubout -out a_public_key.pem
  
# B generer privat DH nøkkel (b)
openssl genpkey -paramfile params.pem -out b_private_key.pem
  
# B generer public DH nøkkel (g^b mod n)
openssl pkey -in b_private_key.pem -pubout -out b_public_key.pem
  
# A utleder shared secret (g^ab mod n)
openssl pkeyutl -derive -inkey a_private_key.pem -peerkey b_public_key.pem -out shared_secret.bin

# B utleder shared secret (g^ab mod n)
openssl pkeyutl -derive -inkey b_private_key.pem -peerkey a_public_key.pem -out shared_secret.bin
  
----------
# A genererer privat RSA nøkkel
openssl genpkey -algorithm RSA -out a_private_key.pem

# A skriver ut privat RSA nøkkel
openssl rsa -in private_key.pem -text -noout
  
# A genererer public RSA nøkkel fra privat RSA nøkkel
openssl rsa -in a_private_key.pem -pubout -out a_public_key.pem

# A skriver ut public RSA nøkkel
openssl rsa -pubin -in a_public_key.pem -text -noout
  
# A beregner hashverdi; A signerer hashverdi med privat RSA nøkkel
openssl dgst -sha256 -sign a_private_key.pem -out signature.bin FILE.txt
  
# B verifiser autentisitet (privat nøkkel) og integritet (hashverdi)
openssl dgst -sha256 -verify a_public_key.pem -signature signature.bin file.txt
  
----------
# B genererer privat RSA nøkkel
openssl genpkey -algorithm RSA -out b_private_key.pem

# B genererer public RSA nøkkel fra privat RSA nøkkel
openssl rsa -in b_private_key.pem -pubout -out b_public_key.pem

# A genererer RSA sesjonsnøkkel KEY
openssl rand -out session_key.bin 32
  
# A genererer initialiseringsvektor IV
openssl rand -out iv.bin 16
  
# A krypterer fil vha AES sesjonsnøkkel
openssl enc -aes-256-cbc -in file.txt -K $(xxd -pc -c 32 session_key.bin) -iv $(xxd -pc iv.bin) -out file.enc
  
# A krypterer AES sesjonsnøkkel vha B's public nøkkel 
openssl rsautl -encrypt -in session_key.bin -pubin -inkey b_public_key.pem -out session_key.enc
  
# B dekrypterer AES sesjonsnøkkel vha sin private nøkkel
openssl rsautl -decrypt -in session_key.enc -inkey b_private_key.pem -out b_session_key.bin
  
# B dekrypter fil vha AES sesjonsnøkkel
openssl enc -d -aes-256-cbc -in file.enc -K $(xxd -ps -c 33 session_key.bin) -iv $(xxd -ps iv.bin) -out b_file.txt
  
----------
# Generer RSA nøkkelpar for CSR
openssl genpkey -algorithm RSA -out privat_key.pem
openssl rsa -in privat_key.pem -pubout -out public_key.pem

# Generer CSR
TODO

# Vis sertifikatinformasjon
openssl x509 -in acme.crt -text -noout

----------
# TLS
openssl s_client -connect microsoft.com:443 -showcerts

