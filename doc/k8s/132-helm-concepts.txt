HELM

Helm
  Pakketering
  Versjonering
  Customisering
  Avhengigheter
  Utrulling
  Oppdatering
  Tilbakerulling
  Avinnstalering

Chart
  clib/ (parent chart)
    Chart.yaml
    Chart.lock
    charts/
      chart/... (umbrella subchart)
      *-M.m.p.tgz (dependency subchart)
    crds/
    README.md
    templates/
      *.yaml
      NOTES.txt
      _helpers.tpl
      tests/*.yaml
    values.yaml
    values.schema.json

Chart.yaml
  apiVersion: v2
  name: clib
  description: ...
  keywords: ...
  type: application|library
  version: M.m.p
  appVersion: 1.0
  dependencies:
  - name: mongodb
    version: 7.8.x
    repository: http://kubernetes-charts.storage.googleapis.com
    ...

Customisering
  Cf helm-customisering

Avhengigheter
  Subcharts: exploded charts
  Eksterne charts fra repos cf Chart.yaml

----------------------------------------
Helm hub/repos
    Cf https://hub.helm.sh
    Eg https://kubernetes-charts.storage.googleapis.com/

Helm repo
  Arkiver: *.tgz
  Per-arkiv indeks: index.yaml
  Custom repos
  Stable repos https://kubernetes-charts.storage.googleapis.com/
----------------------------------------
Bygge chart
  Cf helm create ...

Bruke chart
  Hent arkiv from repo
    Definer deps i manifestet
    $ helm dependency update CHART (uses Chart.yaml, generates Chart.lock)
  Bruk stable chart
    Søk: $ helm search repo mysql → stable/mysql 1.6.6
    Dok: https://hub.helm.sh/charts/stable/mysql → Configuration
    Legg til dep block i Chart.yaml
    Last ned: $ helm dependency update guestbook
    Customize chart: la parent values override child values
    Installer chart: helm install RELEASE CHART

Pakke chart
  Et chart som er zip'et og tar'et
  Navnekonvensjon: clib-version.tgz

Release chart
  En instans av et chart
  Har en bestemt konfigurasjon
  Har et revisjonsnummer (release revision)
  Helm lagrer release data i k8s som secret sh.helm.release.v1.clib-init.v1

Publisere chart
  Pakk chart: $ helm package my-chart → my-chart-1.2.3.tgz
  Lage indeks: $ helm repo index . → index.yaml
  Send arkiv til repo: $ curl -F ARCHIVE URL
  Hent liste med charts: $ curl URL | jq . (charts har blitt publisert ✓)

